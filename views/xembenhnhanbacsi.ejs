<!DOCTYPE html>
<html lang="en">
<head>
  <title>Hệ thống quản lý sức khỏe</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">

</head>
<body>
<div class="container-fluid">
    <div class="row flex-nowrap">
        <div class="col-auto col-md-3 col-xl-2 px-sm-2 px-0 bg-dark">
            <div class="d-flex flex-column align-items-center align-items-sm-start px-3 pt-2 text-white min-vh-100">				
                
                <ul class="nav nav-pills flex-column mb-sm-auto mb-0 align-items-center align-items-sm-start" id="menu">
					
                    <li class="nav-item">
                        <a href="/" class="nav-link align-middle px-0 link-light">
                            <i class="fs-4 bi bi-list"></i> <span class="ms-1 d-none d-sm-inline">Danh sách bệnh nhân</span>
                        </a>
                    </li>
                    <li class="nav-item">
                      <a href="/lichkham" class="nav-link align-middle px-0 link-light">
                          <i class="fs-4 bi bi-calendar-event"></i> <span class="ms-1 d-none d-sm-inline">Lịch
                              khám
                              bệnh</span>
                      </a>
                  </li>
                    <li class="nav-item ">
                        <a href="/hoidap_bacsi" class="nav-link align-middle px-0 link-light">
                            <i class="fs-4 bi bi-reply"></i> <span class="ms-1 d-none d-sm-inline">Phản hồi</span>
                        </a>
                    </li>				          
					
					          <hr>
					          <li class="nav-item">
                        <div class="fixed-bottom m-3">
							            <i class="bi bi-person-fill"></i>
							            <%=un%> | 
							            <a style="text-decoration: none" class="text-white" href="/thoat">Đăng xuất</a>
						            </div>
                    </li>
                </ul>             
				
                
            </div>
        </div>
        <div class="col card">
			<div class="card-body">
				<h2 class="card-title text-center">THÔNG TIN BỆNH NHÂN</h2>
                <div class="container">
                    <div class="row">
                        <div class="col">
                            <img src="uploads/<%= benhnhan.Avatar %>" width="200" class="mx-auto d-block"/>
                        </div>
                        <div class="col-8">
                          <div class="card">
                            <div class="card-header">Chỉ số sức khỏe</div>
                            <div class="card-body">
                              <div class="row">
                                <div class="col-sm-3">
                                  <p class="mb-0">Nhịp tim</p>
                                </div>
                                <div class="col-sm-9">
                                  <p class="text-muted mb-0"><%= Nhiptim %> nhịp/phút</p>
                                </div>
                              </div>
                              <hr>
                              <div class="row">
                                <div class="col-sm-3">
                                  <p class="mb-0">Huyết áp</p>
                                </div>
                                <div class="col-sm-9">
                                  <p class="text-muted mb-0"><%= HATamThu %> / <%= HATamTruong %> mmHg</p>
                                </div>
                              </div>
                              <hr>
                              
                              <div class="row">
                                <div class="col-sm-3">
                                  <p class="mb-0">SpO2</p>
                                </div>
                                <div class="col-sm-9">
                                  <p class="text-muted mb-0"><%= SpO2 %> %</p>
                                </div>
                              </div>
                              <hr>
                              <div class="row">
                                <div class="col-sm-3">
                                  <p class="mb-0">Cân nặng</p>
                                </div>
                                <div class="col-sm-9">
                                  <p class="text-muted mb-0"><%= benhnhan.CanNang %> kg</p>
                                </div>
                              </div>
                              <hr>
                              <% if(tinhtrang=="Bất thường") {%>								
                                <div class="row bg-danger text-white">
                              <%} else {%>
                                <div class="row">
                              <%}%>
                                
                                  <div class="col-sm-3">
                                    <p class="mb-0">Tình trạng</p>
                                  </div>
                                  <div class="col-sm-9">
                                    <p class="mb-0"><%= tinhtrang %></p>
                                  </div>
                                </div>
                              <hr>
                            </div>                                
                          </div>
                        </div>
                        
                    </div>
                </div>
                <hr>
                <div class="card m-3">
                    <div class="card-header">Thông tin cá nhân</div>
                    <div class="card-body">
                      <div class="row">
                        <div class="col-sm-3">
                          <p class="mb-0">Mã bệnh nhân</p>
                        </div>
                        <div class="col-sm-9">
                          <p class="text-muted mb-0"><%= benhnhan.MaBenhNhan %></p>
                        </div>
                      </div>
                      <hr>
                      <div class="row">
                        <div class="col-sm-3">
                          <p class="mb-0">Họ tên</p>
                        </div>
                        <div class="col-sm-9">
                          <p class="text-muted mb-0"><%= benhnhan.TenBenhNhan %></p>
                        </div>
                      </div>
                      <hr>
                      <div class="row">
                        <div class="col-sm-3">
                          <p class="mb-0">Giới tính</p>
                        </div>
                        <div class="col-sm-9">
                          <p class="text-muted mb-0"><%= benhnhan.GioiTinh %></p>
                        </div>
                      </div>
                      <hr>
                      <div class="row">
                        <div class="col-sm-3">
                          <p class="mb-0">Ngày sinh</p>
                        </div>
                        <div class="col-sm-9">
                          <p class="text-muted mb-0"><%= sinh %></p>
                        </div>
                      </div>
                      <hr>
                      <div class="row">
                        <div class="col-sm-3">
                          <p class="mb-0">Số điện thoại</p>
                        </div>
                        <div class="col-sm-9">
                          <p class="text-muted mb-0"><%= benhnhan.SoDienThoai %></p>
                        </div>
                      </div>
                      <hr>
                      <div class="row">
                        <div class="col-sm-3">
                          <p class="mb-0">Địa chỉ email</p>
                        </div>
                        <div class="col-sm-9">
                          <p class="text-muted mb-0"><%= benhnhan.Mail %></p>
                        </div>
                      </div>
                      <hr>
                      <div class="row">
                        <div class="col-sm-3">
                          <p class="mb-0">Địa chỉ</p>
                        </div>
                        <div class="col-sm-9">
                          <p class="text-muted mb-0"><%= benhnhan.DiaChi %></p>
                        </div>
                      </div>
                      <hr>
                      <div class="row">
                        <div class="col-sm-3">
                          <p class="mb-0">Số điện thoại người thân</p>
                        </div>
                        <div class="col-sm-9">
                          <p class="text-muted mb-0"><%= benhnhan.SoDienThoaiNguoiThan %></p>
                        </div>
                      </div>
                      <hr>
                    </div>
                    
                  </div>
            </div>
            <div class="card m-3">
              <div class="card-header">Biểu đồ nhịp tim</div>
              <div class="card-body">
                <div class="container">
                  <canvas id="myChart"></canvas>
                </div>
              </div>
            </div> 
            <% bdnhiptim.forEach(function(bdnt) { %>  
              <p data-foo="<%= bdnt %>" hidden></p> 
            <% }); %>
                
			</div>
            			
		</div>
    </div>
</div>
<script>  
  setInterval(() => {
        location.reload();      
    }, 60000);
</script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const ctx = document.getElementById('myChart');

  var a = document.querySelectorAll('[data-foo]');
    let datanhiptim = [];
    for (var i in a) if (a.hasOwnProperty(i)) {
        datanhiptim[i]=a[i].getAttribute('data-foo');
    }
    console.log(datanhiptim);
	  new Chart(ctx, {
		type: 'line',
		data: {
		  labels: ['0', '2', '4', '6', '8', '10','12','14','16','18','20','22','24'],
		  datasets: [{
			label: 'Nhịp tim',
			data: datanhiptim,
			borderWidth: 1
		  }]
		},
		options: {
		  scales: {
			y: {
			  beginAtZero: true
			}
		  }
		}
		  });
</script>
</body>
</html>